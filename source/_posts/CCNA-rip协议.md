---
title: CCNA-rip协议
tags: [CCNA,笔记]
date: 2014-05-19 22:59:57
keywords: [rip协议]
---

学习过程中的笔记，比较零散

<!--more-->

#### 距离矢量型路由选择协议

距离=跳数（经过几层三层设备，三层以下不算，没有路由）

矢量=出接口（方向）

路由器周期性的从接口向外发送本机的完整路由表

对于rip，周期是30秒

#### 问题 缺点

根据跳数选择，不精确

不一致的路由信息会导致路由环路

导致路由环路的原因：

更新不同步（跳数到无穷大，因此，定义最大跳数15，16跳为不可达，缺点，限制的最大网络直径）

水平分割，split horizon（永远不会将路由信息从接受这个信息的接口上发送回去）

路由毒化（route poisoning）网络down掉之后不是仅仅将路由条目删除，并且把其度量值标记为无限大（16跳），通告网络（类似与泛洪过程，会覆盖水平分割机制，）

毒性逆转 

抑制计时器（hold-down timer）：防止因更新不同步引起的问题（接收到次优路由信息不立即相信）

触发更新（triggered updates）网络拓扑发生变动时，立即发送更新信息，不必等待计时器

#### 距离矢量——收敛过程

路由器在没有配置协议的时候只知道直连的路由

路由器从收集到的源信息中选择到达目标地址的最佳路径

对比自己的路由表，将没有的路由信息加入到自己的路由表中，并且跳数加1，将学习到的路由器做为下一跳的出接口

学习到所有的路由信息才算收敛完成

路由失效

当有一台路由器挂了，与其直连的路由会将接口路由新删除，对于学习来的路由信息，会加上失效计时器（180秒，六个更新周期）每收到一个更新，就会重置。当180秒之后没有收到更新，就会将接口置为possible down

刷新计时器（240秒）过去240秒，删除

#### Rip（route information protocol）

距离矢量型路由协议（判断方法：是否直接发送路由信息）

- RIPv1是有类别的，RIPv2是无类别的，RIPng是IPv6版本
- RIP使用跳数（hop：三层设备）作为度量标准
- 使用UDP协议，端口号520
- 周期性发送更新（默认30秒）
- Ripv1使用广播更新（255.255.255.255）
- Ripv2使用组播更新（224.0.0.9）
- RIP计时器：更新update-30s，失效invalid-180s，抑制holddown-180s，刷新flush-240s



#### rip配置命令

Route rip

Version 1

Network 10.0.0.0(直连的网络，只宣告主类网络)

Network 172.168.0.0（直连网络，只宣告主类网络）

No auto-summary

Clear ip route *   清空路由表

Show IP rip database  （看rip底层数据库）

Debug IP  rip

抖动计时器 （上下浮动15%）不一定是精确的30，防止网络流量过大

一个rip更新最多携带25个路由

调整RIP默认计时器

修改计时器的目的一般是为了加快收敛速度,并且所有的路由计时器一定要一致,一般情况下不要修改默认计时器,否则可能导致由于更新时间导致的路由信息不一致情况

Timer basic 30 180 180 240

更新计时器  失效  抑制  刷新

只有RIPv2支持认证(加密)

启用明文认证之后   只能携带24个路由信息

启用md5认证  只能携带 23个路由信息

在接口下启用认证

1   创建密钥数据库

Key chain  数据库名字

Key 1

Key-string 密码  空格也算

 

2  启动密钥认证

IP rip authentication mode [text | md5]

3  挂载密钥

Ip rip authentication key-chain 密钥链（名字） （挂载可以不一样）

RIPv2手工汇总

只支持子网汇总，不支持超网（不超过主类网的边界）汇总

在接口处启用

Ip summary-address rip 汇总后的IP  子网掩码

 

关闭水平分割（no ip split-rizon）

水平分割默认生效

RIp被动接口及单播更新

被动接口只接收不发送路由更新

Passive-interface 

只向指定的设备发送路由更新(单播)

Neighbor  ip地址

然后配置缺省路由，达到隐藏网络的地址

 

Ripv1  和  ripv2并存（兼容一些不支持ripv2的老式路由器）

在接口上指定发送接收什么版本的rip

Ip rip send version

Ip rip received version